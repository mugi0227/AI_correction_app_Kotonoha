.root-placeholder{}

/* Theme variables */
:root {
  --bg: #f6f8fb;
  --card: #ffffff;
  --text: #0f172a;
  --muted: #6b7280;
  --border: #e5e7eb;
  --accent: #3b82f6;
  --accent-600: #2563eb;
  --accent-50: #eff6ff;
  /* Layout variables */
  --center-width: 980px;
  --center-scale: 0.86; /* 86% */
  --left-width: 320px;
  --right-min: 320px;
  --right-max: 560px;
  --right-scale: 0.88; /* 988% */
}

/* iPad/Tablet friendly scaling */
@media (max-width: 1024px) {
  :root { --center-scale: 0.78; --right-scale: 0.82; }
}
@media (max-width: 900px) {
  :root { --center-scale: 0.72; --right-scale: 0.78; }
}
@media (max-width: 820px) {
  :root { --center-scale: 0.70; --right-scale: 0.75; }
}

/* Elegant subtle background */
body {
  background-color: #f6f8fb;
  background-image:
    radial-gradient(1200px 600px at 110% -10%, rgba(59,130,246,0.20) 0%, rgba(59,130,246,0.08) 40%, transparent 70%),
    radial-gradient(900px 500px at -10% 10%, rgba(16,185,129,0.18) 0%, rgba(16,185,129,0.06) 45%, transparent 70%),
    radial-gradient(1px 1px at 0 0, rgba(15,23,42,0.03) 1px, transparent 0);
  background-size:
    auto,
    auto,
    24px 24px;
  background-attachment: fixed, fixed, fixed;
  background-repeat: no-repeat, no-repeat, repeat;
}

.App {
  text-align: center;
}

/* ADS-like tokens */
@import './ui/tokens.css';

.spinner {
  display: inline-block;
  width: 12px; height: 12px;
  border: 2px solid #cbd5e1;
  border-top-color: #0ea5e9;
  border-radius: 50%;
  animation: sp 1s linear infinite;
  margin-right: 6px;
}
@keyframes sp { to { transform: rotate(360deg); } }

/* Sticky table enhancements */
.answer-list { overflow: auto; }
.answer-list table { width: 100%; border-collapse: separate; border-spacing: 0; }
.answer-list thead th { position: sticky; top: 0; background: #fff; z-index: 2; }
.answer-list th, .answer-list td { border-bottom: 1px solid #e5e7eb; padding: 8px 10px; }
.answer-list th.col-checkbox, .answer-list td.col-checkbox { position: sticky; left: 0; background: #fff; z-index: 3; width: 40px; }
.answer-list th.col-filename, .answer-list td.col-filename { position: sticky; left: 40px; background: #fff; z-index: 2; max-width: 360px; }
.ellipsis { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width: 100%; display: inline-block; }

.toolbar { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
.toolbar-row { display: flex; gap: 12px; align-items: center; justify-content: space-between; flex-wrap: wrap; margin-bottom: 8px; }
.toolbar-left, .toolbar-right { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
.divider { width: 1px; height: 24px; background: var(--ds-border); }

/* Editor toolbar (ADS-ish) */
.ds-toolbar { display:flex; gap:12px; align-items:center; flex-wrap:wrap; padding:8px 10px; background:#fff; border:1px solid var(--ds-border); border-radius:10px; }
.ds-toolbar .ds-group { display:flex; gap:6px; align-items:center; }
.ds-toolbar .ds-group.nowrap { flex-wrap: nowrap; }
.ds-toolbar .ds-sep { width:1px; height:24px; background: var(--ds-border); margin: 0 2px; }
.time-badge { font-weight:700; background:#f1f5f9; border:1px solid #cbd5e1; color:#0f172a; padding:4px 8px; border-radius:8px; }

/* Pager */
.pager-row { display: flex; align-items: center; justify-content: flex-end; gap: 8px; margin: 6px 0 10px; flex-wrap: wrap; }
.pager-row .select { padding: 4px 6px; border: 1px solid var(--ds-border); border-radius: 6px; background: var(--ds-surface); }
.pager-row .btn { padding: 4px 8px; border: 1px solid var(--ds-border); background: var(--ds-surface); border-radius: 6px; cursor: pointer; }
.pager-row .btn:disabled { opacity: .5; cursor: default; }
.muted { color: #64748b; }

/* Hover preview thumbnail */
.hover-thumb { position: fixed; z-index: 2147483646; background: #fff; border: 1px solid var(--ds-border); border-radius: 8px; box-shadow: var(--ds-shadow); padding: 6px; pointer-events: none; }
.hover-thumb img { display: block; max-width: 220px; max-height: 280px; }

/* Mobile cards for answer list */
@media (max-width: 768px) {
  .answer-list table.sticky-head { display: block; }
  .answer-list thead { display: none; }
  .answer-list tbody { display: block; }
  .answer-list tr { display: block; border: 1px solid var(--ds-border); border-radius: 8px; background: #fff; margin: 10px 0; overflow: hidden; }
  .answer-list td, .answer-list th { display: block; border: none; border-bottom: 1px solid var(--ds-border); }
  .answer-list td:last-child { border-bottom: none; }
  .answer-list td { position: relative; padding: 10px 12px; }
  .answer-list td::before { content: attr(data-label); display: block; font-size: 12px; color: #64748b; margin-bottom: 4px; }
  .answer-list th.col-checkbox, .answer-list td.col-checkbox,
  .answer-list th.col-filename, .answer-list td.col-filename { position: static; left: auto; max-width: none; background: #fff; }
  .answer-list td.col-checkbox { position: absolute; top: 8px; right: 8px; padding: 0; border: none; }
  .answer-list td.col-filename { padding-top: 28px; }
}

/* Modern chat panel */
.chat-panel { display:flex; flex-direction:column; height: 100%; border:1px solid var(--ds-border); border-radius:10px; background:#fff; }
.chat-panel .chat-header { display:flex; align-items:center; justify-content:space-between; padding:8px 10px; border-bottom:1px solid var(--ds-border); }
.chat-panel .chat-title { display:flex; align-items:center; gap:8px; font-weight:700; }
.chat-panel .chat-log { flex:1; overflow:auto; padding:10px; background:#f8fafc; }
.chat-panel .chat-msg { display:flex; gap:8px; margin-bottom:10px; align-items:flex-start; }
.chat-panel .chat-avatar { width:28px; height:28px; border-radius:50%; background:#e2e8f0; display:flex; align-items:center; justify-content:center; font-size:14px; }
.chat-panel .chat-bubble { max-width:80%; padding:8px 10px; border-radius:10px; background:#fff; border:1px solid #e5e7eb; }
.chat-panel .chat-bubble.user { background:#e9f2ff; border-color:#cce0ff; }
.chat-panel .chat-bubble.assistant { background:#eef2ff; border-color:#d7dbff; }
.chat-panel .chat-input { display:flex; align-items:center; gap:6px; padding:8px; border-top:1px solid var(--ds-border); background:#fff; }
.chat-panel .chat-input input[type="text"] { flex:1; padding:8px 10px; border:1px solid var(--ds-border); border-radius:8px; }
.chat-panel .chat-attachments { display:flex; gap:6px; padding:6px 8px; border-top:1px dashed var(--ds-border); background:#fff; }
.attach-thumb { position:relative; width:46px; height:46px; border:1px solid var(--ds-border); border-radius:8px; overflow:hidden; }
.attach-thumb img { width:100%; height:100%; object-fit:cover; }
.attach-thumb button { position:absolute; top:2px; right:2px; border:none; background:#fff; border-radius:6px; cursor:pointer; }

/* Quick filter chips */
.chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 8px;
  border-radius: 9999px;
  border: 1px solid var(--ds-border);
  background: var(--ds-surface);
  cursor: pointer;
  font-size: 12px;
}
.chip.active { border-color: #0c66e4; color: #0c66e4; background: #e9f2ff; }

/* Icon button (for edit) */
.icon-btn {
  appearance: none;
  border: 1px solid var(--ds-border);
  background: var(--ds-surface);
  border-radius: 6px;
  padding: 4px;
  line-height: 0;
  cursor: pointer;
}
.icon-btn:hover { background: var(--ds-background-neutral); }
.icon-btn:focus-visible { outline: 2px solid #0c66e4; outline-offset: 2px; }

.App-header {
  padding: 20px;
  border-bottom: 1px solid #444;
}

main {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px;
}

/* --- Upload Component Styles --- */
.upload-container { width:80%; max-width:1000px; margin-bottom:28px; padding:16px; background:#ffffff; border:1px solid #e5e7eb; border-radius:12px; box-shadow:0 2px 12px rgba(15,23,42,0.06); }

.dropzone { border:2px dashed #e5e7eb; border-radius:12px; padding:28px 20px; cursor:pointer; transition: background-color .15s, border-color .15s; }
.dropzone.active { background:#eff6ff; border-color:#3b82f6; }

.file-list {
  text-align: left;
  margin-top: 20px;
}
.file-list ul { list-style:none; padding:10px; max-height:150px; overflow:auto; background:#f8fafc; border:1px solid #e5e7eb; border-radius:8px; }
.file-list li {
  padding: 5px;
  font-size: 0.9rem;
}

.upload-button { background-color:#eaf2ff; color:#0f172a; border:1px solid #93c5fd; padding:10px 16px; border-radius:10px; font-size:1rem; font-weight:600; cursor:pointer; margin-top:16px; box-shadow:0 1px 4px rgba(148,163,184,0.25); }

.status-message {
  margin-top: 15px;
  font-size: 1rem;
  color: #61dafb;
}

/* Small inline spinner for processing indicator */
.spinner {
  display: inline-block;
  width: 12px;
  height: 12px;
  border: 2px solid #cbd5e1;
  border-top-color: #3b82f6;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-right: 6px;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* --- Dashboard Component Styles --- */
.dashboard-container {
  width: 80%;
  max-width: 1000px;
  padding: 16px;
  background-color: #ffffff;
  border: 1px solid #e5e7eb;
  border-radius: 12px;
  box-shadow: 0 2px 12px rgba(15,23,42,0.06);
}

.process-button {
  background-color:#eaf2ff;
  color:#0f172a;
  border:1px solid #93c5fd;
  padding: 12px 18px;
  border-radius: 10px;
  font-size: 1.05rem;
  font-weight: 600;
  cursor: pointer;
  margin-bottom: 16px;
  box-shadow: 0 1px 4px rgba(148,163,184,0.25);
}
.process-button:disabled {
  background-color: #cbd5e1;
  cursor: not-allowed;
}

.answer-list {
  width: 100%;
}

.answer-list table {
  width: 100%;
  border-collapse: collapse;
}

.answer-list th, .answer-list td { padding: 12px; border-bottom: 1px solid var(--border); text-align: left; }

.answer-list th { background: var(--card); }
.answer-list tbody tr:hover { background: #f9fafb; }
.answer-list tbody tr.completed { background: #e0f2fe; }

/* Ensure dashboard text is black for readability */
.dashboard-container { color:#000; }

.status {
  padding: 4px 10px;
  border-radius: 999px;
  font-size: 0.78rem;
  font-weight: 600;
  border: 1px solid #e5e7eb;
  background: #f8fafc;
  color: #6b7280;
}

.status-未処理 {
  background-color: #888;
  color: #fff;
}
.status-処理中 {
  background-color: #f0ad4e;
  color: #fff;
}
.status-PNG変換済 {
  background-color: #5bc0de;
  color: #fff;
}
.status-仕分け中 {
  background-color: #f0ad4e;
  color: #fff;
}
.status-仕分済-自動可 {
  background-color: #5cb85c;
  color: #fff;
}
.status-仕分済-要手動確認 {
  background-color: #f0ad4e;
  color: #fff;
}
.status-書き起こし中 {
  background-color: #f0ad4e;
  color: #fff;
}
.status-書き起こし済 {
  background-color: #5bc0de;
  color: #fff;
}
.status-特定中 {
  background-color: #f0ad4e;
  color: #fff;
}
.status-特定済 {
  background-color: #5cb85c;
  color: #fff;
}
.status-エラー,
.status-エラー-問題なし,
.status-エラー-特定失敗 {
  background-color: #d9534f;
  color: #fff;
}

.delete-button {
  background-color: #d9534f;
  color: white;
  border: none;
  padding: 5px 10px;
  border-radius: 5px;
  font-size: 0.8rem;
  cursor: pointer;
}
.delete-button:hover {
  background-color: #c9302c;
}

/* --- Review Panel Styles --- */
.review-panel {
  width: 90%;
  max-width: 1000px;
  margin-top: 20px;
  padding: 16px;
  border-radius: 12px;
  background-color: #f0f9ff; /* sky */
  border: 1px solid #bae6fd;
  text-align: left;
  box-shadow: 0 2px 12px rgba(15,23,42,0.04);
}
.review-header {
  display: block;
  margin-bottom: 12px;
}
.review-top { margin-bottom: 6px; }
.review-header h3 { margin: 0; font-weight: 700; color:#0f172a; overflow-wrap:anywhere; }
.review-meta { display:flex; flex-wrap: wrap; gap:8px; align-items:center; justify-content: space-between; }

/* Markdown preview styles */
.md-preview {
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial, sans-serif;
  line-height: 1.6;
  color: #111827;
}
.md-preview h1, .md-preview h2, .md-preview h3 {
  margin: 0.8em 0 0.4em;
}
.md-preview h1 { font-size: 1.4rem; border-bottom: 1px solid #e5e7eb; padding-bottom: 0.3rem; }
.md-preview h2 { font-size: 1.2rem; }
.md-preview h3 { font-size: 1.05rem; }
.md-preview p { margin: 0.5em 0; }
.md-preview code { background: #f3f4f6; padding: 0 0.25em; border-radius: 4px; }
.md-preview pre { background: #0b1020; color: #e5e7eb; padding: 0.75rem; overflow: auto; border-radius: 6px; }
.md-preview ul, .md-preview ol { padding-left: 1.25rem; }
.md-preview blockquote { border-left: 4px solid #e5e7eb; margin: 0.75rem 0; padding: 0.25rem 0 0.25rem 0.75rem; color: #374151; background: #fafafa; }
.md-preview table { border-collapse: collapse; }
.md-preview th, .md-preview td { border: 1px solid #e5e7eb; padding: 0.4rem 0.6rem; }
.md-preview a { color: #2563eb; text-decoration: none; }
.md-preview a:hover { text-decoration: underline; }
.review-summary { display:flex; flex-wrap:wrap; gap:8px; }
.review-header .actions { display:flex; gap:8px; align-items:center; }
.btn-ghost-sky { background:#eaf2ff; color:#0f172a; border:1px solid #93c5fd; padding:6px 10px; border-radius:8px; cursor:pointer; }
.btn-ghost-sky:hover { filter: brightness(0.98); }
.review-summary {
  display: flex;
  gap: 12px;
  font-size: 0.95rem;
}
.badge {
  display: inline-block;
  padding: 4px 8px;
  border-radius: 12px;
  background-color: #e0f2fe;
  color: #0369a1;
}
.question-card {
  background-color: #e0f2fe;
  border: 1px solid #bae6fd;
  border-radius: 8px;
  padding: 12px;
  margin: 10px 0;
}
.question-title {
  font-weight: bold;
  margin-bottom: 6px;
}
.comment {
  margin: 6px 0;
  font-size: 0.95rem;
}
.comment.score { color: #7fe1ff; }
.comment.mistake { color: #ff9da3; }
.comment.guidance { color: #ffdd7a; }
.comment.praise { color: #a2ffb5; }

.small-button, .review-button { background:#eaf2ff; color:#0f172a; border:1px solid #93c5fd; padding:6px 10px; border-radius:8px; cursor:pointer; font-size:0.85rem; box-shadow:0 1px 4px rgba(148,163,184,.25); }
.review-button { background: var(--accent-600); }
.small-button:hover { filter: brightness(0.95); }

/* Force button label color to dark for better readability on light backgrounds */
.small-button, .review-button, .process-button, .upload-button { color: #0f172a !important; }

.reprocess-panel {
  margin-top: 10px;
  padding: 10px;
  background: #2f3340;
  border-radius: 8px;
}
.reprocess-panel label { margin-right: 10px; }

/* --- Editor Styles --- */
.editor-container {
  width: 100%;
  margin-top: 24px;
  display: grid;
  grid-template-columns: minmax(0,1fr) calc(var(--center-width,980px) * var(--center-scale,1)) minmax(0,1fr);
  gap: 16px;
  align-items: start;
  justify-content: center; /* center the fixed-width middle column */
}
/* Explicitly place children into grid columns to keep center fixed */
.editor-container > .left-rail { grid-column: 1; }
.editor-container > .canvas { grid-column: 2; }
.editor-container > .sidebar { grid-column: 3; }
.canvas { background:#ffffff; border:1px solid #e5e7eb; border-radius:12px; padding:12px; box-shadow:0 2px 12px rgba(15,23,42,0.04); }
.canvas { width: calc(var(--center-width,980px) * var(--center-scale,1)); }
.editor-header { display:grid; grid-template-columns: 1fr auto auto; gap:8px; align-items:center; margin-bottom:12px; }
.editor-title { font-weight:700; color:#0f172a; overflow-wrap:anywhere; }
.editor-sub { font-size:0.85rem; color:#6b7280; }
.editor-head-center { display:flex; gap:8px; align-items:center; justify-content:center; }
.editor-head-right { display:flex; gap:8px; align-items:center; justify-content:flex-end; flex-wrap:wrap; }
@media (max-width: 1024px) {
  .editor-header { grid-template-columns: 1fr auto; }
  .editor-head-right { justify-content:flex-start; }
}
.page-view {
  position: relative;
  margin: 0 auto;
  max-width: 100%;
  overflow: auto;
  -webkit-overflow-scrolling: touch; /* smooth scrolling on iOS */
  overscroll-behavior: contain;      /* avoid rubber-banding into parent */
}
.page-view.drawing {
  touch-action: none;
  -webkit-overflow-scrolling: auto;
}
.page-view.placing { cursor: crosshair; }
.page-toolbar { position: sticky; top: 0; z-index: 5; background: #ffffff; padding-bottom: 6px; }
.sidebar { position: sticky; top: 12px; width: var(--right-min,320px); justify-self: start; min-width: 280px; max-width: 720px; overflow: auto; }
.sidebar-split { display: grid; grid-template-columns: 1fr 360px; gap: 8px; align-items: start; }
.chat-floating { position: sticky; top: 12px; width: 360px; float: right; }
.chat-panel { background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:10px; }
.chat-log { max-height: 380px; overflow:auto; border:1px solid #f1f5f9; border-radius:10px; padding:10px; background:#f8fafc; }
.chat-empty { color:#6b7280; font-size:.9rem; padding:8px; text-align:center; }
.chat-msg { display:flex; gap:8px; margin:10px 6px; align-items:flex-start; }
.chat-msg.user { flex-direction: row-reverse; }
.chat-avatar { width:28px; height:28px; border-radius:50%; background:#e2e8f0; display:flex; align-items:center; justify-content:center; font-size:16px; }
.chat-bubble { max-width: 78%; padding:10px 12px; border-radius:14px; box-shadow:0 1px 2px rgba(0,0,0,0.06); }
.chat-bubble.user { background:#e0f2fe; border:1px solid #bae6fd; }
.chat-bubble.assistant { background:#ecfdf5; border:1px solid #a7f3d0; }
.chat-text { white-space: pre-wrap; line-height:1.5; }
.chat-images { display:flex; gap:6px; margin-bottom:6px; flex-wrap:wrap; }
.chat-images img { max-width: 160px; max-height: 120px; border-radius:8px; border:1px solid #e5e7eb; background:#fff; }
.chat-attachments { display:flex; gap:8px; flex-wrap:wrap; padding:8px 0; }
.attach-thumb { position:relative; width:72px; height:72px; border:1px solid #e5e7eb; border-radius:8px; overflow:hidden; background:#fff; }
.attach-thumb img { width:100%; height:100%; object-fit:cover; }
.attach-thumb button { position:absolute; right:2px; top:2px; border:none; background:rgba(0,0,0,0.6); color:#fff; border-radius:50%; width:18px; height:18px; cursor:pointer; }
.chat-input { display:flex; gap:6px; margin-top:6px; align-items:center; }
@media (max-width: 1100px) { .chat-floating { width: 100%; float:none; } }
.page-view.capturing .resize-handle,
.page-view.capturing .edge-handle,
.page-view.capturing .small-button {
  display: none !important;
}
.page-view.capturing .box.selected {
  border-color: transparent !important;
}
.render-box {
  position: absolute;
  color: #ff4141;
  pointer-events: none;
  padding: 6px;
  box-sizing: border-box;
  white-space: pre-wrap;
  text-align: left;
  line-height: normal;
  z-index: 2;
}
.page-image {
  max-width: 100%;
  height: auto;
  display: block;
  pointer-events: none; /* allow overlays to receive interactions in combined view */
}
.page-image.stack { opacity: 0.9; margin-top: 16px; }
.page-wrap { position: relative; }
.page-wrap + .page-wrap { margin-top: 16px; }
.page-view.capturing .page-image.stack { display: none !important; }
.draw-canvas {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 2;
}
.stroke-width-control {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 12px;
  color: #475569;
}
.stroke-width-control input[type="range"] {
  width: 120px;
}
.stroke-width-control span:last-child {
  min-width: 32px;
  text-align: right;
}
.curation-controls { display: grid; gap: 12px; margin-bottom: 1rem; }
.curation-controls.two-col { grid-template-columns: 1fr; }
@media (min-width: 900px) { .curation-controls.two-col { grid-template-columns: 1fr 1fr; } }
.curation-panel { background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:12px; }
.curation-panel .control-group { display:flex; flex-direction: column; gap:6px; }
.curation-panel select, .curation-panel input { padding:8px; border:1px solid #e5e7eb; border-radius:8px; }
.box {
  position: absolute;
  background: transparent;
  border: 1px dashed transparent;
  color: #ff4141;
  padding: 0;
  border-radius: 4px;
  cursor: move;
  user-select: none;
  -webkit-user-select: none;
  touch-action: none; /* prefer drag over scroll for interactive overlays */
  font-family: "MS Mincho", "Hiragino Mincho ProN", "Yu Mincho", "YuMincho", "Noto Serif JP", serif;
  z-index: 3;
}
.box textarea {
  width: 100%;
  height: 100%;
  background: transparent;
  color: #ff4141;
  border: none;
  resize: none;
  outline: none;
  font-family: "MS Mincho", "Hiragino Mincho ProN", "Yu Mincho", "YuMincho", "Noto Serif JP", serif;
  padding: 6px;
  box-sizing: border-box;
  position: relative;
  z-index: 1;
}
.box.selected { border-color: rgba(255,65,65,0.8); }
.resize-handle {
  position: absolute;
  width: 12px;
  height: 12px;
  background: #ff6b6b;
  border-radius: 2px;
  cursor: se-resize;
  z-index: 5;
  touch-action: none; /* don't translate to scroll/zoom on touch */
}
.resize-handle.tl { left: -6px; top: -6px; cursor: nw-resize; }
.resize-handle.tr { right: -6px; top: -6px; cursor: ne-resize; }
.resize-handle.bl { left: -6px; bottom: -6px; cursor: sw-resize; }
.resize-handle.br { right: -6px; bottom: -6px; cursor: se-resize; }

.edge-handle {
  position: absolute;
  background: rgba(255,107,107,0.6);
  z-index: 5;
  touch-action: none;
}
.edge-handle.l { left: -3px; top: 25%; width: 6px; height: 50%; cursor: w-resize; }
.edge-handle.r { right: -3px; top: 25%; width: 6px; height: 50%; cursor: e-resize; }

/* Hover edge highlight to mirror single-page UX */
.edge-highlight { position:absolute; top:25%; height:50%; width:6px; z-index:4; pointer-events:none; }
.edge-highlight.l { left:-3px; background: rgba(255,107,107,0.35); }
.edge-highlight.r { right:-3px; background: rgba(255,107,107,0.35); }
.sidebar { background:#f0f9ff; border:1px solid #bae6fd; border-radius:12px; padding:12px; overflow:auto; box-shadow:0 2px 12px rgba(15,23,42,0.04); }
.sidebar { position: sticky; top: 12px; max-height: calc(100vh - 120px); }
.sidebar h4 { margin: 6px 0; color:#0f172a; }
.comment-item { padding:8px; margin:8px 0; background:#e0f2fe; border:1px solid #bae6fd; border-radius:10px; cursor:pointer; color:#0f172a; }
.toolbar {
  display: flex;
  gap: 8px;
  margin-top: 10px;
  align-items: flex-start; /* allow multi-line content inside groups to align nicely */
  flex-wrap: nowrap;       /* keep groups on one row (groups won't jump rows) */
}
.icon-btn {
  background: #eaf2ff;
  color: #0f172a;
  border: 1px solid #93c5fd;
  width: 34px;
  height: 34px;
  border-radius: 8px;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  box-shadow: 0 1px 4px rgba(148,163,184,.25);
}
.icon-btn:hover { filter: brightness(0.95); }
.icon-btn.wide { width: auto; padding: 6px 10px; }
.toolbar .group { display: inline-flex; gap: 6px; align-items: center; flex-wrap: wrap; row-gap: 6px; }
.toolbar .group.column { display:flex; flex-direction: column; align-items: flex-start; gap:6px; }
.toolbar .group-row { display:inline-flex; gap:6px; align-items:center; }
.group-label { font-size: 0.78rem; color:#6b7280; }
.toolbar input[type="number"] { width:64px; padding:6px 8px; border-radius:8px; border:1px solid #bae6fd; background:#ffffff; color:#0f172a; }
/* group spacing: separate groups more than inner controls */
.group-separated .group + .group { margin-left: 16px; }

/* Compact page toolbar layout */
.page-toolbar { display:flex; flex-wrap:wrap; align-items:center; justify-content:space-between; gap:10px; margin-bottom:10px; }
.page-toolbar .nav { display:inline-flex; gap:6px; align-items:center; }


/* Problem panel */
.problem-panel { margin-top: 12px; }
.problem-header { display:flex; justify-content:space-between; align-items:center; cursor:pointer; background:#3a3f4a; padding:8px; border-radius:6px; }
.problem-body { margin-top:6px; background:#242833; padding:8px; border-radius:6px; max-height:260px; overflow:auto; white-space:pre-wrap; }
.asset-list a { color:#9fd0ff; text-decoration: none; }

.tabs { display:flex; gap:6px; margin:6px 0; }
.tab { padding:6px 10px; background:#3a3f4a; border-radius:6px; cursor:pointer; }
.tab.active { background:#55607a; font-weight:bold; }
.pdf-controls { display:flex; flex-direction:column; gap:6px; margin-bottom:6px; }
.pdf-controls select { width:100%; background:#3a3f4a; color:#fff; border:1px solid #555; border-radius:6px; padding:6px; }
.pdf-embed { width:100%; height:360px; background:#111; border:1px solid #444; border-radius:6px; }

/* score circle */
.score-chip {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: #ff4141;
  border: 2px solid #ff4141;
  border-radius: 9999px;
  background: transparent;
  font-weight: bold;
  height: 1.6em;
  padding: 0 0.25em;
  line-height: 1;
}
.score-marker {
  position: absolute;
  display: flex;
  align-items: center;
  gap: 6px;
  color: #ff4141;
  user-select: none;
  -webkit-user-select: none;
  cursor: move;
  z-index: 3;
  touch-action: none;
}

/* Bigger hit targets for touch devices */
@media (pointer: coarse) {
  .resize-handle { width: 18px; height: 18px; border-radius: 3px; }
  .edge-handle.l, .edge-handle.r { width: 10px; }
  .icon-btn { width: 38px; height: 38px; }
}
.score-bracket {
  font-family: "MS Mincho", "Hiragino Mincho ProN", "Yu Mincho", "YuMincho", "Noto Serif JP", serif;
  font-size: 2.0em;
  line-height: 1;
  margin-right: -20px;
  font-weight: bold;
}

/* Toast notifications */
.toast-container {
  position: fixed;
  top: 12px;
  left: 12px;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.toast {
  background: #ffffff;
  border: 1px solid #e5e7eb;
  border-left-width: 4px;
  border-radius: 8px;
  box-shadow: 0 2px 12px rgba(15,23,42,0.08);
  padding: 8px 12px;
  color: #0f172a;
  min-width: 220px;
  max-width: 360px;
}
.toast.info { border-left-color: #93c5fd; }
.toast.success { border-left-color: #34d399; }
.toast.error { border-left-color: #f87171; }
.toast .title { font-weight: 600; margin-right: 8px; }
.toast .actions { margin-top: 6px; display: flex; gap: 6px; }
.toast .actions .btn { background:#eaf2ff; color:#0f172a; border:1px solid #93c5fd; padding:4px 8px; border-radius:6px; cursor:pointer; font-size:0.8rem; }

.App-header {
  background-color: #fff;
  padding: 12px 2rem;
  color: #0f172a;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid #e5e7eb;
  box-shadow: 0 1px 3px rgba(15,23,42,0.03);
}

.App-header h1 {
  margin: 0;
  font-size: 1.5rem;
}

/* Inner nav for dashboard */
.inner-nav {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 1rem;
  border-bottom: 1px solid var(--border);
}

.inner-nav button {
  background-color: transparent;
  color: var(--muted);
  border: none;
  padding: 0.5rem 1rem;
  border-bottom: 2px solid transparent;
  cursor: pointer;
  font-size: 1rem;
  font-weight: 500;
  transition: all 0.2s;
  margin-bottom: -1px; /* Overlap the container's border */
}

.inner-nav button:hover {
  color: var(--text);
}

.inner-nav button.active {
  color: var(--accent-600);
  border-bottom-color: var(--accent-600);
  font-weight: 600;
}

.curation-content.disabled {
  opacity: 0.6;
}

.asset-list-container {
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 0.5rem;
  background-color: #f8fafc;
  max-height: 300px;
  overflow-y: auto;
}

.asset-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.asset-list li {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.5rem;
  border-bottom: 1px solid var(--border);
}
.asset-list li:last-child {
  border-bottom: none;
}

.asset-list a {
  color: var(--accent-600);
  text-decoration: none;
  font-weight: 500;
}
.asset-list a:hover {
  text-decoration: underline;
}

.asset-type {
  font-size: 0.8rem;
  padding: 2px 6px;
  border-radius: 4px;
  color: var(--muted);
  background-color: #e5e7eb;
}
.asset-type.pdf { background-color: #fee2e2; color: #b91c1c; }
.asset-type.text { background-color: #dbeafe; color: #1e40af; }
.asset-type.image { background-color: #d1fae5; color: #065f46; }

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.view-fade-in {
  animation: fadeIn 0.4s ease-out forwards;
}

.editor-container {
  position: relative;
  display: grid;
  grid-template-columns: minmax(0,1fr) calc(var(--center-width,980px) * var(--center-scale,1)) minmax(0,1fr);
  gap: 12px;
  align-items: start;
}
.editor-container.chat-hidden { grid-template-columns: minmax(0,1fr) calc(var(--center-width,980px) * var(--center-scale,1)) minmax(0,1fr); }
.editor-container.chat-hidden .left-rail { display: none; }
.editor-container.chat-hidden .left-rail { display: none; }

.close-editor-btn {
  position: absolute;
  top: -2.5rem;
  left: 0;
  z-index: 10;
  background-color: #f8fafc;
  color: #0f172a;
  border: 1px solid #e5e7eb;
  padding: 0.5rem 1rem;
  border-radius: 8px;
  cursor: pointer;
  font-size: 1rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  transition: all 0.2s;
  box-shadow: 0 1px 3px rgba(0,0,0,0.04);
}

.close-editor-btn:hover {
  background-color: #f1f5f9;
  box-shadow: 0 2px 8px rgba(0,0,0,0.06);
}
.editor-grid {
  display: grid;
  grid-template-columns: var(--left-width,320px) var(--center-width,980px) minmax(var(--right-min,320px), 1fr);
  gap: 12px;
  align-items: start;
}
.left-rail { position: sticky; top: 12px; width: var(--left-width,320px); justify-self: end; }

@media (max-width: 1400px) {
  .editor-container { grid-template-columns: minmax(0,1fr) calc(var(--center-width,980px) * var(--center-scale,1)) minmax(0,1fr); }
  .left-rail { display: none; }
}

/* Floating chat drawer (does not affect layout) */
.chat-drawer {
  position: fixed;
  left: 12px;
  top: 80px;
  bottom: 20px; /* define bottom to create a fixed height */
  width: 320px;
  z-index: 2147483647; /* above right drawer */
}
.chat-drawer .chat-panel { height: 100%; display: flex; flex-direction: column; }
.chat-drawer .chat-log { flex: 1 1 auto; overflow: auto; -webkit-overflow-scrolling: touch; }
/* Ensure chat log scrolls also when docked (left rail) */
.chat-panel .chat-log { overflow: auto; }
/* Floating right drawer for comments */
.right-drawer {
  position: fixed;
  right: 8px;
  top: 80px;
  bottom: 20px; /* define bottom to create a fixed height */
  /* Ensure width never collapses on small viewports */
  width: max(
    calc(var(--right-min,320px) * var(--right-scale,1)),
    calc(
      min(
        var(--right-max,560px),
        calc(100vw - 48px - (var(--center-width,980px) * var(--center-scale,1)))
      ) * var(--right-scale,1)
    )
  );
  z-index: 2147483646;
  display: flex;
  flex-direction: column;
}
.right-panel { background:#fff; border:1px solid #e5e7eb; border-radius:8px; padding:8px; height: 100%; overflow:auto; -webkit-overflow-scrolling: touch; }
